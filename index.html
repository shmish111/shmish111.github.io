<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
<meta name="twitter:description">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-2016-05-03-generative-testing" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/03/2016-05-03-generative-testing/" class="article-date">
  <time datetime="2016-05-02T23:00:00.000Z" itemprop="datePublished">2016-05-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/03/2016-05-03-generative-testing/">Generative Testing</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I have gone through various stages of learning about testing software and how it relates to producing great products so I’d like to write a small series of posts based around this experience, detailing what I’ve learnt along with some real world examples. In this first instalment I’m going to introduce generative and property based testing.</p>
<h2 id="Property-Based-Testing"><a href="#Property-Based-Testing" class="headerlink" title="Property Based Testing"></a>Property Based Testing</h2><p>Property based testing is a method of testing functions pioneered by the Haskell community. From Hackage:</p>
<blockquote>
<p>QuickCheck is a library for random testing of program properties.</p>
<p>The programmer provides a specification of the program, in the form of properties which functions should satisfy, and QuickCheck then tests that the properties hold in a large number of randomly generated cases.</p>
</blockquote>
<p>As a simple example lets say you have a function which will reverse a vector of integers. You provide a ‘generator’ which will generate vectors of random size containing random integer, you then use these as inputs into your functions. Finally you provide a set of properties that should hold true, in this example we can say that reversing a list twice should result in the original list. A library such as QuickCheck or Clojure’s <code>test.check</code> will then try to find an example that will cause the test to fail by generating hundreds or thousands of test cases.</p>
<p>This all sounds great however all the online examples are testing small, pure functions that are only a small part of the software we write. Impressive as it is, I was struggling to see how often I would use this type of testing in my everyday development of systems such as HTTP microservices, which often have limited functionality and not much complex logic. That all changed once I started to have go however.</p>
<h2 id="Generative-Testing"><a href="#Generative-Testing" class="headerlink" title="Generative Testing"></a>Generative Testing</h2><p>The first thing to note is that property based testing libraries have 2 distinct parts. The first is a clever test runner that will try to find the simplest failing case, the second is a framework for random value generation. It was these value generators that interested me the most as they can be used very effectively without the test runner.</p>
<p>I believe that one of the most valuable ways to test software is to test against the API of whatever you are developing, with an HTTP microservice this is the HTTP endpoints. I like to run up an instance of the microservice and consider that to be the unit that I am testing. It’s easy to write tests that send requests via HTTP and it’s usually easy to verify the results. When you write these tests, you will often have to write test data (aka fixtures), for example lets say we have a microservice for dealing with customer details. This is likely a CRUD service so we might write a test that POSTs a new customer and then tries to GET the customer. We will define some sample data to build a new customer request:</p>
<figure class="highlight clj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">def</span></span> a-customer</span><br><span class="line">  &#123;<span class="symbol">:name</span> <span class="string">"David Smith"</span></span><br><span class="line">   <span class="symbol">:age</span> <span class="number">21</span></span><br><span class="line">   <span class="symbol">:gender</span> <span class="string">"male"</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>We can then re-use this in various different tests. We may even turn this into a function to try to vary the details for certain tests:</p>
<figure class="highlight clj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">defn</span></span> a-customer</span><br><span class="line">  [m]</span><br><span class="line">  (<span class="name"><span class="builtin-name">merge</span></span> &#123;<span class="symbol">:name</span>   <span class="string">"David Smith"</span></span><br><span class="line">          <span class="symbol">:age</span>    <span class="number">21</span></span><br><span class="line">          <span class="symbol">:gender</span> <span class="string">"male"</span>&#125;</span><br><span class="line">         m))</span><br></pre></td></tr></table></figure>
<p>An alternative would be to use generators to create our data:  </p>
<figure class="highlight clj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">def</span></span> a-customer</span><br><span class="line">  (<span class="name">gen/hash-map</span> <span class="symbol">:name</span> gen/string</span><br><span class="line">                <span class="symbol">:age</span> gen/int</span><br><span class="line">                <span class="symbol">:gender</span> gen/string))</span><br><span class="line"></span><br><span class="line">(<span class="name">deftest</span> my-test</span><br><span class="line">  (<span class="name"><span class="builtin-name">let</span></span> [new-customer (<span class="name">gen/generate</span> a-customer)]))</span><br></pre></td></tr></table></figure>
<p>So why would you use the generated version? First it means you don’t have to waste your time coming up with witty values but more importantly you are more correctly defining how your function works. In production, the service will not receive a customer whose name is “David Smith”, it will receive a name whose value is a string. With a generator we state this explicitly. On top of that, generators tend to generate loads of rubbish that can screw with your functions surprisingly quickly; you often don’t need to run the tests hundreds of times before some special case breaks it, I’ve found quite a few bugs the first time I hit the service with generated data.</p>
<p>Generators can be a bit daunting at first, I thought that it may become so complicated that you would need to test your generators! It turns out though that this is not the case and property testing libraries have the tools to generate just about anything fairly easily. You can also come up with your own patterns and helpers to make things easier. One of the best examples of this is Prismatic Schema’s experimental generators. Given any schema, the library will provide you with a generator to generate values that conform to this schema. If you are already validating your new customer in the microservice using schema then there is really no work involved:</p>
<figure class="highlight clj"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">sg/generate</span> Customer)</span><br></pre></td></tr></table></figure>
<p>It really is as simple as that, we’ve eliminated the tedious work of writing sample data and at the same time we’ve increased the scope for finding bugs.</p>
<h2 id="Where-next"><a href="#Where-next" class="headerlink" title="Where next"></a>Where next</h2><p>Generators provide some value in creating standard, single, unit and integration tests but they’re not adding that much. Why go to the effort then? In the next instalment we will see how they were crucial in finding hidden bugs in a real-life application.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/03/2016-05-03-generative-testing/" data-id="ciljzfxp20004ngrr1r7904pa" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/08/hello-world/" class="article-date">
  <time datetime="2016-03-08T21:51:25.000Z" itemprop="datePublished">2016-03-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/08/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/03/08/hello-world/" data-id="ciljzdhhj0001kxrrlvy4v72e" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2015-12-15-either-monad-or-exceptions" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/15/2015-12-15-either-monad-or-exceptions/" class="article-date">
  <time datetime="2015-12-15T00:00:00.000Z" itemprop="datePublished">2015-12-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/15/2015-12-15-either-monad-or-exceptions/">Either monad or exceptions</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>TL;DR</strong> The <code>Either</code> monad from <a href="https://github.com/funcool/cats" target="_blank" rel="external">cats</a> is pretty cool.</p>
<p>Recently I was asked to complete a small test for a job interview in the form of a Clojure program. The idea of the program was to take commands from stdin and use them to mess around with a ‘canvas’, basically a super-primitive graphics program. It occured to me that since part of this would involve parsing and validating commands and displaying any errors, it might be a good opportunity to use the Either monad and see the current state of monad libraries in Clojure.</p>
<p>I have used <a href="https://github.com/clojure/algo.monads" target="_blank" rel="external">algo.monads</a> in the past but looking at the project on github I could see that it hadn’t been updated in more than 11 months. I thought that perhaps there has been some work done in this area since then and I discovered <a href="https://github.com/funcool/cats" target="_blank" rel="external">cats</a>. It has some nice documentation and a nice philosophy so I decided to give it a try.</p>
<p>The program flow is:</p>
<ul>
<li>read-line from the console</li>
<li>split the input by the space character</li>
<li>dispatch the arguments and the current state of the program to a multi-method, based on the first argument</li>
<li>return the new state or a string to display on the console</li>
<li>loop round to read-line again</li>
</ul>
<p>This flow allows me to use pure functions for the multi-method as in the following command which flood-fills an area of the canvas:</p>
<figure class="highlight clj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">defn</span></span> valid-number-of-args</span><br><span class="line">  [args n]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> n (<span class="name"><span class="builtin-name">count</span></span> args))</span><br><span class="line">    (<span class="name">right</span> args)</span><br><span class="line">    (<span class="name">left</span> (<span class="name"><span class="builtin-name">str</span></span> <span class="string">"invalid number of arguments, expected "</span> n))))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">defmethod</span></span> do-command <span class="string">"F"</span></span><br><span class="line">  [_ state &amp; args]</span><br><span class="line">  (<span class="name">m/mlet</span> [[x y colour] (<span class="name">valid-number-of-args</span> args <span class="number">3</span>)</span><br><span class="line">           pixel (<span class="name">valid-pixel</span> state x y)</span><br><span class="line">           _ (<span class="name">valid-colour</span> colour)]</span><br><span class="line">          (<span class="name">m/return</span> (<span class="name">flood-fill</span> pixel colour state))))</span><br></pre></td></tr></table></figure>
<p><code>mlet</code> is analogous to do notation in Haskell. <code>valid-number-of-args</code>, <code>valid-pixel</code> and <code>valid-colour</code> are functions that return either a <code>Right</code> containing the value or a <code>Left</code> containing an error.</p>
<p>It’s probably clear that I could have used functions that throw an Exception with the error message, the above would then look like:</p>
<figure class="highlight clj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">defn</span></span> valid-number-of-args</span><br><span class="line">  [args n]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> n (<span class="name"><span class="builtin-name">count</span></span> args))</span><br><span class="line">    args</span><br><span class="line">    (<span class="name"><span class="builtin-name">throw</span></span> (<span class="name">Exception.</span> (<span class="name"><span class="builtin-name">str</span></span> <span class="string">"invalid number of arguments, expected "</span> n)))))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">defmethod</span></span> do-command <span class="string">"F"</span></span><br><span class="line">  [_ state &amp; args]</span><br><span class="line">  (<span class="name"><span class="builtin-name">let</span></span> [[x y colour] (<span class="name">valid-number-of-args</span> args <span class="number">3</span>)</span><br><span class="line">        pixel (<span class="name">valid-pixel</span> state x y)</span><br><span class="line">        _ (<span class="name">valid-colour</span> colour)]</span><br><span class="line">        (<span class="name">flood-fill</span> pixel colour state)))</span><br></pre></td></tr></table></figure>
<p>You could argue that the second version, apart from being slightly more terse, is more idiomatic however I don’t believe this is true, Exceptions in Java were never intended to be used for unexceptional flow, it’s just that they have become commonly used in this way, precisely because they are basically a strange form of the Either monad, why not just use the real thing when dealing with non-exceptional flow? It also looks better if you can avoid instantiating java classes such as <code>Exception</code> in my opinion.</p>
<p>In this particular case the flow is not ‘exceptional’ at all since some of the commands such as ‘S’ which displays the current state on the console, should return a string even though there is no ‘error’. Having a function that always throws an <code>Exception</code> and yet is successful seems a bit dodgy to me. With <code>Either</code> you are not saying that <code>Left</code> are errors but rather that they are strings that should be displayed to the user.</p>
<p>I have also been using promises in the form of <a href="https://github.com/ztellman/manifold" target="_blank" rel="external">manifold</a> a lot recently and the semantics of this are almost exactly the same as <code>Either</code> and <code>mlet</code> above, a manifold <code>deferred</code> is essentially an async <code>Either</code>. Add to this that manifold can be used with cats and it adds up to a more consistent way of doing things. Everything looks the same, it’s just a matter of whether you want something to be async or not.</p>
<p>Finally, because an <code>Exception</code> will keep going up the call-chain until it is caught, it’s possible to introduce bugs where the <code>Execption</code> disappears into the ether, this can be a pain to discover sometimes. Using the <code>Either</code> semantics, Clojure’s type system will usually throw a runtime exception and problems will be slightly easier to spot.</p>
<p>My conclusion is that I like using <code>Either</code> in Clojure and I like cats :) I think I will use both in the future. It’s also nice to note that cats and some related libraries are moving Clojure in directions other than what the clojure.core team is doing. As clojure.core gets better and more innovative, the libraries and tools do as well. It makes me glad to be using Clojure and hopeful for it’s future.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/12/15/2015-12-15-either-monad-or-exceptions/" data-id="ciljzfxp10003ngrr9szt126l" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2014-09-09-static-vs-dynamic" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/09/09/2014-09-09-static-vs-dynamic/" class="article-date">
  <time datetime="2014-09-08T23:00:00.000Z" itemprop="datePublished">2014-09-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/09/09/2014-09-09-static-vs-dynamic/">Static vs Dynamic</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I have recently moved jobs and now I am using Clojure rather than Java and Scala. Before starting I had been reading up on the static vs dynamic typing argument. I enjoy all the type stuff, when you start learning Haskell and Scala there’s some really interesting things to learn and some parts of static typing can really help. Most notable for me is function signatures, I really find function signatures to be one of the best things about static typing.</p>
<p>Once I started using Clojure, however, I was amazed how productive and fun it was. Using functional Scala and Haskell makes you feel clever and when you get something working it’s really satisfying, using Clojure though is just plain fun! It’s so productive, the feedback is instant (I’d recommend trying Light Table with it’s inline evaluation) and you don’t have to fight against the type system.</p>
<p>Of course this comes at a cost, the main downsides supposedly being</p>
<ol>
<li>difficult to understand and navigate a large codebase</li>
<li>lack of refactoring in tooling</li>
<li>it’s slow</li>
<li>minor bugs that would have been caught by the type checker</li>
</ol>
<p>The company I moved to has a fairly large and complex codebase of a reasonable age (around 4 years) but I was amazed at how easy it was to understand and navigate. I have no doubt that you could make something truly incomprehensible with Clojure but the thing is it doesn’t actually lend itself to this.</p>
<p>First of all it’s pretty terse: Before I started my new job I re-wrote a program in Clojure that I had recently written in Groovy. I compared a function for manipulating some data that was reasonably complex, both the Groovy and the Clojure version were the same size in terms of lines of code. However the Groovy project was around 1300 lines of code verses around 350 for the Clojure project! This suggests to me that a huge amount of space was taken up by the Java-style boilerplate code required, lets multiply that by 10 and imagine how easy a codebase of 3000 lines is to understand compared to 13000… I have no doubt that a Java version would have been even worse.</p>
<p>Something else about the maintainability of a decent size codebase in Clojure is that the culture is that of making small, specific libraries and spending time thinking about the API of these libraries. This leads to quite a lot of projects but good separation of concerns. It also makes it easier to open source parts of your codebase.</p>
<p>Moving on to refactoring and tooling, I definitely found there were a few refactoring features I missed, find usages in a project was the biggest one. However I found, as I had read, that with Clojure, text manipulation is far more important than cross-file refactoring. I didn’t really miss much and there’s a lot to be said for weak autocomplete actually forcing you to understand the code better.</p>
<p>Speed is an interesting one. Clojure can be optimized to be not far off the speed of Java however you sacrifice idiomaticity and it will never be quite as fast. The thing is though that this single thread speed is not often a requirement, especially as Clojure makes parallelism much easier. When it becomes an issue though, it is quite easy to integrate Java for performance, a good quote is from the http-kit blog, “Clojure + JAVA = Performance + Nice API”.</p>
<p>Finally we come to bugs. I’m not sure about this, I imagine it’s true but I haven’t been working with Clojure long enough to see. So far I haven’t come across a bug that would not have existed with a type checker but that’s just circumstantial.</p>
<p>Perhaps in a few years I’ll change my mind but for now I’m sold on the advantages of dynamic languages and I’m embarrassed to say that I have even become a bit of a Clojure fan-boy :(</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2014/09/09/2014-09-09-static-vs-dynamic/" data-id="ciljzfxp00002ngrroeveren9" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2014-08-10-configuring-rest-api-endpoint-in-angular" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/10/2014-08-10-configuring-rest-api-endpoint-in-angular/" class="article-date">
  <time datetime="2014-08-09T23:00:00.000Z" itemprop="datePublished">2014-08-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/10/2014-08-10-configuring-rest-api-endpoint-in-angular/">Configuring REST API endpoint in angular</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I’ve been slowly plodding away learning javascript and the associated ecosystem recently and I have to say the speed with which the community develops new tools and libraries is awesome.  I’m not really a big fan of javascript as a language but it is fun writing an Angular JS app.  The trouble with this speed though is that documentation and examples tend to be a bit thin on the ground, hence this post which can hopefully help someone in a similar situation.</p>
<p>You have a single page Angular JS app which is backed by a RESTfull API.  You would like to be able to run the app without the API service running, using just dummy data.  I think there’s probably an infinite number of ways to do this with angular and I went through quite a few of them but here is what I found worked best for my situation.</p>
<ul>
<li>Services that interact with the API use a wrapper service around $http</li>
<li>The wrapper service simply adds a prefix to the url using an angular variable</li>
<li>The app has 2 versions, the prod app and the dev app which extends the prod app</li>
<li>The root of the API is set in prod app and overridden in the dev app</li>
<li>The app then contains a static resource structure, nested folders containing json in files.  As a side-effect this will indicate just how ‘RESTfull’ my service is!</li>
<li>The static resources and dev app are included only in the dev build in Gulp</li>
<li>The ng-app value in index.html is set in the Gulp build using gulp-template</li>
</ul>
<p>Here’s the code</p>
<p><code>app/services.js</code></p>
<pre><code>services.service(&apos;ApiService&apos;, [&apos;$http&apos;, &apos;apiPrefix&apos;, function($http, apiPrefix) {
  this.get = function(url) {
    return $http.get(apiPrefix + url);
  };
  this.post = function(url, data) {
    return $http.post(apiPrefix + url, data);
  };
  this.put = function(url, data) {
    return $http.put(apiPrefix + url, data);
  };
}]);

services.service(&apos;EmailsService&apos;, [&apos;ApiService&apos;, function(ApiService) {
  this.get = function(id) {
    return ApiService.get(&apos;/emails/&apos; + id);
  };
}]);
</code></pre><p><code>app/app.js</code></p>
<p>This is the production version of the angular app</p>
<pre><code>var app = angular.module(&apos;myApp&apos;, []);
...other app config...
app.value(&apos;apiPrefix&apos;, &quot;http://localhost:8080&quot;);
</code></pre><p><code>app/app-dev.js</code></p>
<p>This is the dev version of the app.  It takes the prod app as a module and extends it.</p>
<pre><code>var app = angular.module(&apos;myAppDev&apos;, [&apos;myApp&apos;])
  .value(&apos;apiPrefix&apos;, &quot;http://localhost:5000&quot;);
</code></pre><p><code>app/index.html</code></p>
<pre><code>&lt;html lang=&quot;en&quot; ng-app=&quot;&lt;%= appName %&gt;&quot;&gt;
...the rest of the index html...
&lt;/html&gt;
</code></pre><p><code>Gulpfile.js</code></p>
<pre><code>...gulp imports...
var browserify = require(&apos;gulp-browserify&apos;);
var template = require(&apos;gulp-template&apos;);

...lots of other gulp stuff goes here...

function doBrowserify(appSrc, appName) {
  gulp.src([appSrc])
  .pipe(browserify({
    insertGlobals: true,
    debug: true,
    transform: [&apos;debowerify&apos;]
  }))
  .pipe(concat(&apos;bundle.js&apos;))
  .pipe(gulp.dest(&apos;dist/js&apos;));

  gulp.src(&apos;app/index.html&apos;)
        .pipe(template({appName: appName}))
        .pipe(gulp.dest(&apos;dist&apos;));
};

gulp.task(&apos;browserify&apos;, function() {
  doBrowserify(&apos;app/scripts/app.js&apos;, &apos;myApp&apos;);
});

gulp.task(&apos;dev-browserify&apos;, function() {
  doBrowserify(&apos;app/scripts/app-dev.js&apos;, &apos;myAppDev&apos;);
});

// Add some static test data that can be used in place of a real REST service
gulp.task(&apos;testdata&apos;, function() {
  gulp.src(&apos;app/testdata/**&apos;)
  .pipe(gulp.dest(&apos;dist&apos;))
  .pipe(refresh(lrserver));
});
</code></pre><p><code>app/testdata/emails/1</code> (note this file has no extension, it is simply called ‘1’)</p>
<pre><code>{
  &quot;to&quot;: &quot;some@ddress.com&quot;,
  &quot;subject&quot;: &quot;hello&quot;
}
</code></pre><p>And that’s it!  Now my app can be used by simply serving from a static web server, this will also be good for testing as I know exactly what data will be available.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2014/08/10/2014-08-10-configuring-rest-api-endpoint-in-angular/" data-id="ciljzfxoy0001ngrri9q47iwf" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2014-07-09-consistency-is-not-the-key" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/09/2014-07-09-consistency-is-not-the-key/" class="article-date">
  <time datetime="2014-07-08T23:00:00.000Z" itemprop="datePublished">2014-07-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/09/2014-07-09-consistency-is-not-the-key/">Consistency is not the key</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Everyone’s heard it, probably everyone’s said it and on the face of it it makes sense, “We need a consistent approach”, “Consistency will make our code more maintainable”, “Consistency will make it easier for new joiners to understand the code”.  These days though, when it comes to software development, I’ve learnt to question everything and I’m questioning this attitude.</p>
<p>TL;DR Consistency certainly has a place in development but it should never restrict innovation and improvement.</p>
<p>The problem I have with consistency is that I find what it usually means is consistently doing something in a legacy way.  Lets take tools as an example.</p>
<p>I’ve just been pushing for a move from subversion to git.  Some of our projects have a problem with git so we have 3 choices:</p>
<ol>
<li>Find a solution to the problem</li>
<li>Leave the problematic projects in subversion and move the rest to git</li>
<li>Stay using subversion</li>
</ol>
<p>Option 1 is ideal but it may take too long or perhaps not even be possible right now.<br>Option 2 enables us to improve the way we work but we will have 2 places to go to to find our code.<br>Option 3 is avoiding innovation to maintain consistency.  We are conciously deciding to limit the scope with which we can improve our workflows and dev ops process, among other things.</p>
<p>For me it’s obvious, start with option 2 and move to option 1 if you can.</p>
<p>Next we can look at code; instead of driving consistency, drive idiomaticity.  Idiomatic code is consistent, but it’s much more than that, it’s a way of writing your code that many people better than us have come to agree is usually best.  The word idiomatic doesn’t seem to be used much in the Java/C# world but you find it all the time in functional language communities.  Idiomatic code is not just consistent within your team, it’s consistent within the community.  It is not however, consistent in time.  Idioms evolve with a language, they are always up to date but that means you also need to stay up to date.</p>
<p>On to architecture.  This is the area where there is probably the most bad consistency.  I think some people think of architecture as something that should be decided upon once at the start of a big project and we should stick with it through thick and thin because architecture is hard to change.  To that I say, if it’s hard to change then it’s not a good architecture and you should improve it.  Architecture is the enabler of improvement, that is why it’s so crucial to agile development.  It is also evolving quickly, new technologies and new ideas lead to new ways of architecting systems.  An architecture that seemed pretty good five years ago is almost definitely not the best way to do things now (although a lot of the concepts will still be the same).</p>
<p>Finally we have team process.  Consistency here should be used in a different way.  New ideas need to be given a chance before they are either accepted or modified.  You should maintain consistency in the majority of your process whilst you pick areas to expermint with.  Just make sure you consistently try new ideas!</p>
<p>Technology evolves so quickly that finding a good way of doing something and sticking with it means you are effectively going backwards.  If you don’t make improvements to each of the 4 areas mentioned above every day then you will quickly find yourself in a legacy world of pain and you will not be able to keep up with the competition.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2014/07/09/2014-07-09-consistency-is-not-the-key/" data-id="ciljzfxor0000ngrrprspgmnn" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2014-07-07-coding-is-easy" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/07/2014-07-07-coding-is-easy/" class="article-date">
  <time datetime="2014-07-06T23:00:00.000Z" itemprop="datePublished">2014-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/07/2014-07-07-coding-is-easy/">Coding is easy, software development is hard</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Software developers like to write code.  Well that makes sense but software development is the process of delivering working code to an environment where it provides value to a user.  In my experience, a developer will generally spend their time doing the following tasks:</p>
<ul>
<li>Requirements Gathering</li>
<li>Writing code</li>
<li>Manual testing</li>
<li>Releasing</li>
</ul>
<p>This is what happens even though you have dedicated QA, operations and business analysts.  And with good reason; testing, releasing and requirements gathering need the input of the people who write the code.  There is no escape, it doesn’t matter whether you are writing your own app or working as part of a massive team, it’s a critical part of the process.  What’s more is that in the most successfull teams that I’ve worked in, coding took up less of my time than the other 3 tasks.</p>
<p>So embrace it.  Test and release automation are complex and should be interesting for people who enjoy writing software.  Requirements gathering?  Well it is what you make of it I guess.  It can be really rewarding to build good relationships with the stakeholders and to learn about the business in which you are working.</p>
<p>As an individual, if you do not embrace them then you will forever be unhappy as you will be forced to do things that you don’t want to do.  If as a team you do not embrace them then you will end up with bottlenecks at the boundries between the tasks, you will not get software to production as quickly as you otherwise could, it will have more bugs and it will be less suited to what the user really needs.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2014/07/07/2014-07-07-coding-is-easy/" data-id="ciljzf5i50001mgrrw40llvol" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2014-06-24-the-trouble-with-scrum" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/24/2014-06-24-the-trouble-with-scrum/" class="article-date">
  <time datetime="2014-06-23T23:00:00.000Z" itemprop="datePublished">2014-06-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/24/2014-06-24-the-trouble-with-scrum/">The Trouble With Scrum</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>In Scrum (and other time-boxed methods) a commitment is made at the start of the sprint to complete a certain amount of work.  This approach encourages on-time delivery of features, a team only commits to what it thinks it can do based on previous iterations and it makes sure this is delivered.  If things got a bit close towards the end then in the next sprint they should commit to a bit less and visa versa.  This seems like a noble and pragmatic approach at first however there are some flaws, mostly due to human nature.</p>
<p>Most people want to meet their commitments, that’s the whole idea, so what happens when things get a bit tight towards the end of the sprint, what is sacrificed in order to meet those commitments?  For most people it’s always going to be quality.  It makes sense, it’s the only thing you have available to sacrifice really and it can be fixed later.  So lets move to the next sprint, in planning a commitment should be made to fix the lack of quality of the last sprint, you over-estimated and so pushed some of the work into the next sprint.</p>
<p>The problem is that this rarely happens, new features are alluring and the time taken to remove this quality debt can easily be under-estimated.  This debt repayment is again left over as the sprint draws to a close and eventually it disappears into the unknown.  What this has resulted in is variation in quality and to make things worse, this variation inevitably leads to a degradation in overall quality and over time lack of quality reduces a team’s velocity.</p>
<p>So what’s the solution?  First, agree on a consistent level of quality.  Things do not have to be perfect but they should meet consistent, well defined criteria.  This level can hopefully be increased over time as the team becomes better at ensuring quality.</p>
<p>Second, this quality level must become part of the definition of done.  Usually done definitions include something vague about the level of testing but this needs to be more explicit and defined in terms of real metrics, processes and practices which a feature must meet in order to be done.</p>
<p>Lastly, consider changing iterations from being time based to feature based, the most common approach being kanban.  There are many advantages to developing and releasing around features rather than time, not least of which is reducing the temptation to sacrifice quality in order to meet a self-imposed deadline.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2014/06/24/2014-06-24-the-trouble-with-scrum/" data-id="ciljzf5hz0000mgrrw5o0k43s" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2014-06-13-functional-programming-ruined-my-life" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/13/2014-06-13-functional-programming-ruined-my-life/" class="article-date">
  <time datetime="2014-06-12T23:00:00.000Z" itemprop="datePublished">2014-06-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/13/2014-06-13-functional-programming-ruined-my-life/">Functional Programming Ruined My Life</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I used to be happy.  I learned Java, then Spring, after that there was TDD and BDD, finally I started using ScalaTest.  Each of these steps made me a better developer, made my job more enjoyable and last but not least they made me more employable.  </p>
<p>Then came functional programming.  At first it was difficult, trying weird flat map stuff in Scala, not knowing what the hell my colleagues were talking about, not really getting it, but over a period of 3 months I had a revolution of the mind. Haskell and Clojure were reasonably easy to learn and understand, all the crazy ScalaZ stuff didn’t look quite so crazy and I started to look at coding in a slightly different way.  Then I started to have heretical thoughts, perhaps Object Orientation isn’t as good as it’s made out to be, perhaps all these experienced programmers that I respect are missing something important, perhaps there is more to the world of software development than Java and C#?  </p>
<p>Still everything was good, I was with like-minded people developing an awesome product in a creative and agile team.  </p>
<p>But then came the dark times, our project was cancelled, our team disbanded to the four corners of the enterprise and I was stuck programming a BPMS connected by SOAP to an ESB.  I tried to use my new way of thinking in the project, tried to provide my team-mates with alternative ways of thinking and coding but there was always resitance.  People preffered imperitive ways of writing code where to me it looked so much more beautiful in a functional style.  If you haven’t yet reached a certain breakthrough level in FP I think it’s hard to see the beauty and this means it’s hard for a team to change.  </p>
<p>So I started looking for another job.  There are some Scala jobs out there however when I had interviews people didn’t really know much about functional programming.  I have a thirst for learning but there’s nobody to learn from.  I don’t know what to do, I feel trapped.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2014/06/13/2014-06-13-functional-programming-ruined-my-life/" data-id="ciljzerjq0000m1rrxzr9tphm" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2014-06-07-too-many-whens" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/07/2014-06-07-too-many-whens/" class="article-date">
  <time datetime="2014-06-06T23:00:00.000Z" itemprop="datePublished">2014-06-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/07/2014-06-07-too-many-whens/">Too many Whens</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I’ve put in quite a lot of effort learning about automated testing in the last few years and have become quite passionate (some may say opinionated) about the subject.  Through trial and error, reading and working with some experienced QAs, I’ve formed some rules for myself about how I write BDD style tests.  I’d like to share one of these as I can’t find anything on the internet that suggests or explains it.  The rule is:</p>
<p>A scenario should only ever have one ‘When’ statement.</p>
<p>Consider the scenario below:</p>
<pre><code>Given a user logs in
And the user is an administrator
When they click on &apos;my profile&apos;
And they click on &apos;view my cart&apos;
Then their shopping cart should be displayed
When they click on an item
Then the item details should be displayed
And the price should be displayed
</code></pre><p>I’ve seen similar scenarios to this many times. It could be made a lot clearer by applying the ‘When’ rule:</p>
<pre><code>Given a user logs in
And the user is an administrator
When they click on &apos;my profile&apos;
Then the &apos;view my cart&apos; button is displayed

Given an administrator is on the &apos;view cart&apos; page
And the cart contains items
When they click on an item
Then the item details should be displayed
And the price should be displayed
</code></pre><p>In order to apply the rule it was necessary to split the scenario into two.  With a bit of practice and attention you eventually see that every scenario can be viewed as a state transition.  The system starts in state A, an action is performed, the system is now in state B.  Uncle Bob wrote about this way back in 2008 <a href="https://sites.google.com/site/unclebobconsultingllc/the-truth-about-bdd" target="_blank" rel="external">The Truth About BDD</a>.</p>
<p>I challenge you to find a feature that is not clearer and easier to understand when it has only one When in each scenario.</p>
<p>That’s all well and good when we are just writing specifications, but what happens when we start to use these specifications as automated tests? There is a weakness in this method; by ensuring only one thing is tested at a time, the state of the system needs to be set up more often.  For example, in the scenarios above we will need to log in to the system twice instead of once, a UI automation task that could be quite expensive and slow down our test suite.</p>
<p>In some situations it is just not practical to do this and clarity and detail must be sacrificed in order to make the tests usable.  However I feel that too often people will state this reason, do more manual testing, produce lower quality software and become less agile when perhaps they could spend some of this time working on ways to speed up the test suite.</p>
<p>Have a go writing your scenarios using this rule and see what happens.  If you think it’s not practical for some of your tests, challenge your team to make the tests run faster, by parallelizing them for example (I’ve got some ideas on this I’ll put in another post).</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2014/06/07/2014-06-07-too-many-whens/" data-id="ciljzejl50000lrrr0vroy9hw" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">June 2014</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/05/03/2016-05-03-generative-testing/">Generative Testing</a>
          </li>
        
          <li>
            <a href="/2016/03/08/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2015/12/15/2015-12-15-either-monad-or-exceptions/">Either monad or exceptions</a>
          </li>
        
          <li>
            <a href="/2014/09/09/2014-09-09-static-vs-dynamic/">Static vs Dynamic</a>
          </li>
        
          <li>
            <a href="/2014/08/10/2014-08-10-configuring-rest-api-endpoint-in-angular/">Configuring REST API endpoint in angular</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>